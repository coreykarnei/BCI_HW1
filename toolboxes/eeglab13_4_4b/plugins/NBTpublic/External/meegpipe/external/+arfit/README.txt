I have borrowed this code from TAPIO SCHNEIDER:

http://www.clidyn.ethz.ch/arfit/index.html